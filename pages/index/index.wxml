<!--index.wxml-->
<wxs src="./index.wxs" module="tool" />
<view class="container">
	<scroll-view class="body {{tool.isPlaying(playingTrack) ? 'body-playing' : ''}}" scroll-y="{{true}}">
		<view class='header'>{{eps[epIndex].name}}</view>

		<view class="audio-list">
			<view
			 class="audio-item {{tool.isActive(index, playingTrack, epIndex) ? 'active' : ''}}"
			 wx:for="{{eps[epIndex].audios}}"
			 wx:key="index"
			 bindtap="handlePlay"
			 data-audio="{{item}}"
			 data-index="{{index}}"
			>
				<image class="audioImg" src="{{eps[epIndex].img}}" />
				<view class="audioIndex">{{tool.pad(index + 1)}}</view>
				<view class="audioTitle">{{item.title}}</view>
				<view class="audioLength">{{item.length}}</view>
			</view>
		</view>

		<view class="info">
			<view>
				<text>本页面素材来自菲伯尔钢琴官网</text>
			</view>
			<view>
				https://pianoadventures.cn
			</view>
		</view>

		<view class="footer" />
	</scroll-view>

	<view class="bottom-area">
		<!-- 菜单按钮 -->
		<view class='icon-wrapper iconMenu' hover-class="iconMenuHover" bindtap='toPickerShow'>
			<i class="icon icon-small" style="background-image: url({{icons.menu}})" />
		</view>

		<!-- 正在播放 -->
		<view wx:if="{{tool.isPlaying(playingTrack)}}" class="audio-item active playingAudio">
			<image class="audioImg" src="{{eps[playingTrack.epIndex].img}}" />
			<view class="audioIndex">{{tool.pad(playingTrack.index + 1)}}</view>
			<view class="audioTitle">{{playingTrack.title}}</view>
			<view class='icon-wrapper iconClose' bindtap='closePlaying'>
				<i class="icon icon-small" style="background-image: url({{icons.close}})" />
			</view>
			<text wx:if="{{waiting}}" class="audioLoading">加载中...</text>
		</view>

		<!-- 控制区域 -->
		<view class="play-area-content">

			<!-- 回退 -->
			<view hover-class="todo" class='icon-wrapper iconBack iconTip' bindtap="playBack">
				<i class="icon" style="background-image: url({{icons.playBack}})" />
			</view>

			<!-- 暂停 -->
			<view
			 wx:if="{{audioStatus === 2}}"
			 class='icon-wrapper icon-wrapper-large'
			 hover-class="icon-hover"
			 bindtap="pause"
			>
				<i class="icon icon-large" style="background-image: url({{icons.pause}})" />
			</view>
			<!-- 播放 -->
			<view
			 wx:else
			 class='icon-wrapper icon-wrapper-large'
			 hover-class="icon-hover"
			 bindtap="play"
			>
				<i class="icon icon-large" style="background-image: url({{icons.play}})" />
			</view>

			<!-- 快进 -->
			<view hover-class="todo" class='icon-wrapper iconForward iconTip' bindtap="playForward">
				<i class="icon" style="background-image: url({{icons.playForward}})" />
			</view>

			<!-- 重新播放 -->
			<view hover-class="icon-hover-rotate" class='icon-wrapper iconRight iconTip' bindtap="refresh">
				<i class="icon" style="background-image: url({{icons.refresh}})" />
			</view>
		</view>
	</view>

	<mp-half-screen-dialog extClass='picker' show="{{pickerShow}}" closabled="{{false}}">
		<view slot='title' class="pickerTitle" catch:touchmove="catchTouchMove">
			<view class="flexBetween">
				<text class="cancelText" bindtap="toPickerHide" >取消</text>
				<text class='confirmText' bindtap="confirmPick" >确认</text>
			</view>
		</view>
		<picker-view
		 slot='desc'
		 value="{{[epIndex]}}"
		 indicator-style="height: 60px;"
		 style="width: 100%; height: 250px; z-index: 100"
		 bindchange="pickerChange"
		>
			<picker-view-column>
				<view wx:for="{{eps}}" wx:key="item" class='pickerRow'>
					<image style="width: 48px; height: 48px; margin-right: 12px" src="{{item.img}}" />
					<view>
						{{item.name}}
					</view>
				</view>
			</picker-view-column>
		</picker-view>
	</mp-half-screen-dialog>
</view>

